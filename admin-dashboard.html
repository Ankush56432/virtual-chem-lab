<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard | Virtual Chemistry Lab</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { padding: 20px; }
h2 { margin-top: 30px; }
</style>
</head>
<body>

<h1 class="text-center mb-5">Admin Dashboard</h1>

<!-- Contact Queries Section -->
<h2>Contact Queries</h2>
<table class="table table-striped" id="contactsTable">
  <thead>
    <tr>
      <th>Date</th>
      <th>Name</th>
      <th>Email</th>
      <th>Message</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<!-- Workshop Registrations Section -->
<h2>Workshop Registrations</h2>
<table class="table table-striped" id="registrationsTable">
  <thead>
    <tr>
      <th>Date</th>
      <th>Name</th>
      <th>Email</th>
      <th>Qualification</th>
      <th>Phone</th>
      <th>Workshop</th>
      <th>Fees</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const ADMIN_PASSWORD = "admin123"; // Change this

// Password Protection
let password = prompt("Enter admin password to access dashboard:");
if(password !== ADMIN_PASSWORD){
    alert("Incorrect password! Access denied.");
    document.body.innerHTML = "<h3 class='text-center text-danger mt-5'>Access Denied</h3>";
} else {
    // Load Contacts
    async function loadContacts(){
        try{
            const res = await fetch("http://localhost:5000/api/contacts");
            const data = await res.json();
            const tbody = document.querySelector("#contactsTable tbody");
            tbody.innerHTML = "";
            data.forEach(c => {
                const tr = document.createElement("tr");
                tr.innerHTML = `
                  <td>${new Date(c.date).toLocaleString()}</td>
                  <td>${c.name}</td>
                  <td>${c.email}</td>
                  <td>${c.message}</td>
                `;
                tbody.appendChild(tr);
            });
        } catch(err){
            console.error(err);
            alert("Cannot load contact queries.");
        }
    }

    // Load Registrations
    async function loadRegistrations(){
        try{
            const res = await fetch("http://localhost:5000/api/registrations");
            const data = await res.json();
            const tbody = document.querySelector("#registrationsTable tbody");
            tbody.innerHTML = "";
            data.forEach(r => {
                const tr = document.createElement("tr");
                tr.innerHTML = `
                  <td>${new Date(r.date).toLocaleString()}</td>
                  <td>${r.name}</td>
                  <td>${r.email}</td>
                  <td>${r.qualification}</td>
                  <td>${r.phone}</td>
                  <td>${r.workshopTitle}</td>
                  <td>â‚¹${r.fees}</td>
                `;
                tbody.appendChild(tr);
            });
        } catch(err){
            console.error(err);
            alert("Cannot load workshop registrations.");
        }
    }

    // Load both tables
    loadContacts();
    loadRegistrations();
}
</script>

</body>
</html>
