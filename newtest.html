<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Registration Confirmation - VirtualChem Labs</title>
</head>
<body style="margin:0; padding:0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height:100vh;">
  
  <!-- Main Container -->
  <div style="max-width:680px; margin:0 auto; padding:40px 20px;">
    
    <!-- Email Card -->
    <div style="background:#ffffff; border-radius:20px; overflow:hidden; box-shadow:0 20px 60px rgba(0,0,0,0.15);">
      
      <!-- Header with Gradient -->
      <div style="background:linear-gradient(135deg, #0ea5e9 0%, #06b6d4 100%); padding:20px 10px; text-align:center; position:relative;">
        <div style="position:absolute; top:0; left:0; width:100%; height:90%; opacity:0.1; background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,0.1) 10px, rgba(255,255,255,0.1) 20px);"></div>
        
        <div style="position:relative; z-index:1;">
          <h1 style="color:#ffffff; margin:0; font-size:32px; font-weight:700; letter-spacing:-0.5px;">Registration Confirmed!</h1>
          <p style="color:rgba(255,255,255,0.9); margin:12px 0 0; font-size:16px; font-weight:400;">Your workshop seat is reserved and payment is complete</p>
        </div>
        <!-- Success Checkmark -->
        <div style="margin-top:25px; position:relative; z-index:1;">
          <div style="width:80px; height:80px; margin:0 auto; background:rgba(255,255,255,0.2); border-radius:50%; display:flex; align-items:center; justify-content:center; backdrop-filter:blur(10px);">
            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M20 6L9 17L4 12" stroke="#ffffff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
        </div>
      </div>
      
      <!-- Body Content -->
      <div style="padding:45px 40px; color:#1f2937;">
        
        <!-- Greeting -->
        <div style="margin-bottom:35px;">
          <h2 style="color:#0f172a; font-size:24px; margin:0 0 12px; font-weight:600;">Hello <span style="color:#0ea5e9;">${registrationData.name}</span>,</h2>
          <p style="font-size:16px; line-height:1.7; color:#475569; margin:0;">We're thrilled to confirm your registration for our upcoming workshop! Your journey into advanced chemistry simulations begins here. Get ready for an engaging and transformative learning experience.</p>
        </div>
        
        <!-- Workshop Details Card -->
        <div style="margin:30px 0; background:linear-gradient(135deg, #ecfeff 0%, #cffafe 100%); border-radius:16px; padding:32px; border:2px solid #a5f3fc; position:relative; overflow:hidden;">
          <div style="position:absolute; top:-20px; right:-20px; width:100px; height:100px; background:rgba(6,182,212,0.1); border-radius:50%;"></div>
          <div style="position:relative; z-index:1;">
            <div style="display:flex; align-items:center; margin-bottom:24px;">
              <div style="width:48px; height:48px; background:#06b6d4; border-radius:12px; display:flex; align-items:center; justify-content:center; margin-right:15px; flex-shrink:0;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect x="3" y="6" width="18" height="15" rx="2" stroke="#ffffff" stroke-width="2"/>
                  <path d="M3 10h18M8 6V4M16 6V4" stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>
                </svg>
              </div>
              <h3 style="margin:0; color:#0c4a6e; font-size:20px; font-weight:700;">Workshop Details</h3>
            </div>
            
            <div style="margin-bottom:18px;">
              <div style="color:#0c4a6e; font-weight:600; font-size:14px; margin-bottom:6px;">üìö Workshop Title</div>
              <div style="color:#164e63; font-size:16px; line-height:1.5;">${registrationData.workshopTitle}</span></div>
            </div>
            
            <div style="border-top:1px solid rgba(6,182,212,0.2); padding-top:18px; margin-bottom:18px;">
              <div style="color:#0c4a6e; font-weight:600; font-size:14px; margin-bottom:6px;">üìÖ Date</div>
              <div style="color:#164e63; font-size:16px;">09 - 18 January 2026</div>
            </div>
            
            <div style="border-top:1px solid rgba(6,182,212,0.2); padding-top:18px; margin-bottom:18px;">
              <div style="color:#0c4a6e; font-weight:600; font-size:14px; margin-bottom:6px;">‚è∞ Time</div>
              <div style="color:#164e63; font-size:16px;">7:30 PM - 9:00 PM</div>
            </div>
            
            <div style="border-top:1px solid rgba(6,182,212,0.2); padding-top:18px;">
              <div style="color:#0c4a6e; font-weight:600; font-size:14px; margin-bottom:6px;">üíª Mode</div>
              <div style="color:#164e63; font-size:16px;">Online via Google Meet</div>
            </div>
          </div>
        </div>
        
        <!-- Participant Information Card -->
        <div style="margin:30px 0; background:linear-gradient(135deg, #f0fdfa 0%, #ccfbf1 100%); border-radius:16px; padding:32px; border:2px solid #99f6e4; position:relative; overflow:hidden;">
          <div style="position:absolute; bottom:-20px; left:-20px; width:100px; height:100px; background:rgba(5,150,105,0.1); border-radius:50%;"></div>
          <div style="position:relative; z-index:1;">
            <div style="display:flex; align-items:center; margin-bottom:24px;">
              <div style="width:48px; height:48px; background:#10b981; border-radius:12px; display:flex; align-items:center; justify-content:center; margin-right:15px; flex-shrink:0;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="12" cy="8" r="4" stroke="#ffffff" stroke-width="2"/>
                  <path d="M6 21v-2a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v2" stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>
                </svg>
              </div>
              <h3 style="margin:0; color:#064e3b; font-size:20px; font-weight:700;">Participant Information</h3>
            </div>
            
            <div style="margin-bottom:18px;">
              <div style="color:#064e3b; font-weight:600; font-size:14px; margin-bottom:6px;">Full Name</div>
              <div style="color:#065f46; font-size:16px;">${registrationData.name}</div>
            </div>
            
            <div style="border-top:1px solid rgba(5,150,105,0.2); padding-top:18px; margin-bottom:18px;">
              <div style="color:#064e3b; font-weight:600; font-size:14px; margin-bottom:6px;">Email Address</div>
              <div style="color:#065f46; font-size:16px;">${registrationData.email}</div>
            </div>
            
            <div style="border-top:1px solid rgba(5,150,105,0.2); padding-top:18px; margin-bottom:18px;">
              <div style="color:#064e3b; font-weight:600; font-size:14px; margin-bottom:6px;">Phone Number</div>
              <div style="color:#065f46; font-size:16px;">${registrationData.phone}</div>
            </div>
            
            <div style="border-top:1px solid rgba(5,150,105,0.2); padding-top:18px; margin-bottom:18px;">
              <div style="color:#064e3b; font-weight:600; font-size:14px; margin-bottom:6px;">Institution</div>
              <div style="color:#065f46; font-size:16px;">${registrationData.institute}</div>
            </div>
            
            <div style="border-top:1px solid rgba(5,150,105,0.2); padding-top:18px; margin-bottom:18px;">
              <div style="color:#064e3b; font-weight:600; font-size:14px; margin-bottom:6px;">Department</div>
              <div style="color:#065f46; font-size:16px;">${registrationData.department}</div>
            </div>
            
            <div style="border-top:1px solid rgba(5,150,105,0.2); padding-top:18px;">
              <div style="color:#064e3b; font-weight:600; font-size:14px; margin-bottom:6px;">Designation</div>
              <div style="color:#065f46; font-size:16px;">${registrationData.designation}</div>
            </div>
          </div>
        </div>
        
        <!-- Payment Confirmation Card -->
        <div style="margin:30px 0; background:linear-gradient(135deg, #ecfeff 0%, #e0f2fe 100%); border-radius:16px; padding:32px; border-left:6px solid #22c55e; box-shadow:0 4px 15px rgba(34,197,94,0.15); position:relative; overflow:hidden;">
          <div style="position:absolute; top:-30px; right:-30px; width:120px; height:120px; background:rgba(34,197,94,0.08); border-radius:50%;"></div>
          <div style="position:relative; z-index:1;">
            <div style="display:flex; align-items:center; margin-bottom:24px;">
              <div style="width:48px; height:48px; background:#22c55e; border-radius:12px; display:flex; align-items:center; justify-content:center; margin-right:15px; box-shadow:0 4px 12px rgba(34,197,94,0.3); flex-shrink:0;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M9 11l3 3L22 4" stroke="#ffffff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11" stroke="#ffffff" stroke-width="2" stroke-linecap="round"/>
                </svg>
              </div>
              <div>
                <h3 style="margin:0 0 4px; color:#065f46; font-size:20px; font-weight:700;">Payment Confirmed</h3>
                <p style="margin:0; color:#059669; font-size:13px; font-weight:500;">Transaction completed successfully</p>
              </div>
            </div>
            
            <div style="margin-bottom:18px;">
              <div style="color:#0c4a6e; font-weight:600; font-size:14px; margin-bottom:6px;">Payment ID</div>
              <div style="color:#164e63; font-size:14px; font-family:monospace; background:rgba(255,255,255,0.5); padding:8px 12px; border-radius:6px; word-break:break-all;">${razorpay_payment_id}</div>
            </div>
            
            <div style="border-top:1px solid rgba(6,182,212,0.2); padding-top:18px; margin-bottom:18px;">
              <div style="color:#0c4a6e; font-weight:600; font-size:14px; margin-bottom:6px;">Order ID</div>
              <div style="color:#164e63; font-size:14px; font-family:monospace; background:rgba(255,255,255,0.5); padding:8px 12px; border-radius:6px; word-break:break-all;">${razorpay_order_id}</div>
            </div>
            
            <div style="border-top:1px solid rgba(6,182,212,0.2); padding-top:18px; margin-bottom:18px;">
              <div style="color:#0c4a6e; font-weight:600; font-size:14px; margin-bottom:8px;">Amount Paid</div>
              <div style="color:#065f46; font-weight:700; font-size:28px;">‚Çπ${registrationData.fees}</div>
            </div>
            
            <div style="border-top:1px solid rgba(6,182,212,0.2); padding-top:18px;">
              <div style="color:#0c4a6e; font-weight:600; font-size:14px; margin-bottom:8px;">Status</div>
              <span style="display:inline-block; background:#dcfce7; color:#15803d; padding:8px 20px; border-radius:20px; font-weight:700; font-size:13px; letter-spacing:0.5px;">‚úì SUCCESS</span>
            </div>
          </div>
        </div>
        
       
        
        
        
        <!-- CTA Button -->
        <div style="text-align:center; margin:35px 0;">
          <a href="https://virtualchemlabs.com/workshops" style="display:inline-block; background:linear-gradient(135deg, #0ea5e9 0%, #06b6d4 100%); color:#ffffff; text-decoration:none; padding:16px 40px; border-radius:30px; font-weight:700; font-size:16px; box-shadow:0 8px 20px rgba(14,165,233,0.3);">
            View All Workshops
          </a>
        </div>
        
        <!-- Signature -->
        <div style="margin-top:40px; padding-top:30px; border-top:2px solid #e2e8f0;">
          <p style="margin:0 0 8px; color:#475569; font-size:15px; text-align:center;">Looking forward to seeing you!</p>
          <p style="margin:0; color:#0f172a; font-size:16px; font-weight:700; text-align: center;">The VirtualChem Labs Team</p>
          
        </div>
        
      </div>
      
      <!-- Footer -->
      <div style="background:linear-gradient(135deg, #1e293b 0%, #0f172a 100%); padding:35px 40px; text-align:center;">
       
        <div style="margin-bottom:15px;">
          
        </div>
        <div style="margin-bottom:20px;">
           
            
            </svg>
          </a>
          <a href="https://t.me/virtualchemlabs" style="display:inline-block; width:36px; height:36px; background:rgba(148,163,184,0.1); border-radius:50%; margin:0 6px; text-decoration:none; line-height:36px;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="#94a3b8" xmlns="http://www.w3.org/2000/svg">
  <path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.562 8.161c-.18 1.897-.962 6.502-1.359 8.627-.168.9-.5 1.201-.82 1.23-.697.064-1.226-.461-1.901-.903-1.056-.693-1.653-1.124-2.678-1.8-1.185-.781-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.139-5.062 3.345-.479.329-.913.489-1.302.481-.428-.008-1.252-.241-1.865-.44-.752-.244-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.831-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
</svg>
          </a>
          <a href="https://www.youtube.com/@VirtualChemLabs" style="display:inline-block; width:36px; height:36px; background:rgba(148,163,184,0.1); border-radius:50%; margin:0 6px; text-decoration:none; line-height:36px;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="#94a3b8" xmlns="http://www.w3.org/2000/svg">
  <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
</svg>
              <circle cx="17.5" cy="6.5" r="1.5" fill="#1e293b"/>
            </svg>
          </a>
          <a href="https://www.linkedin.com/company/virtualchem-labs/posts/?feedView=all" style="display:inline-block; width:36px; height:36px; background:rgba(148,163,184,0.1); border-radius:50%; margin:0 6px; text-decoration:none; line-height:36px;">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="#94a3b8" xmlns="http://www.w3.org/2000/svg">
  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
</svg>
          </a>
        </div>
        <p style="margin:0; color:#64748b; font-size:12px; line-height:1.6;">
          ¬© 2025 VirtualChem Labs. All Rights Reserved.<br>
          <a href="#" style="color:#94a3b8; text-decoration:none;">Privacy Policy</a> ¬∑ 
          <a href="#" style="color:#94a3b8; text-decoration:none;">Terms of Service</a> ¬∑ 
          
        </p>
      </div>
      
    </div>
    
   
    
  </div>
  
</body>
</html>






// ---------------------- WEBINAR REGISTRATION ROUTE (SUPER FAST + FIXED) ----------------------

app.post("/api/register-webinar", async (req, res) => {
  try {
    const {
      name,
      email,
      phone,
      institute,
      department,
      designation,
      questions,
      webinarTitle,     // coming from hidden field
      webinarDate,
      webinarTime,
    } = req.body;

    // DEFAULT TITLE if missing
    const finalWebinarTitle =
      webinarTitle || "Unlocking Protein Interactions: A Beginner's Guide to Docking";

    if (!name || !email || !phone) {
      return res.status(400).json({
        status: "error",
        message: "Missing required fields",
      });
    }

    const FROM = "VirtualChem Labs <info@virtualchemlabs.com>";
    const ADMIN = process.env.ADMIN_EMAIL || null;

    // ================= USER EMAIL =================
    const userHtml = `
      <div style="font-family:Arial;padding:20px;">
        <h2 style="color:#06b6d4;">üéâ Webinar Registration Confirmed!</h2>
        <p>Hi <strong>${name}</strong>,</p>

        <p>Thank you for registering for our FREE Webinar:</p>
        <h3 style="color:#0891b2;">${finalWebinarTitle}</h3>

        <p><strong>üìÖ Date:</strong> ${webinarDate || "December 28, 2025"}<br>
        <strong>‚è∞ Time:</strong> ${webinarTime || "7 PM ‚Äì 8 PM IST"}<br>
        <strong>üíª Platform:</strong> Google Meet (link will be sent soon)</p>

        <p>We look forward to seeing you!<br>‚Äî VirtualChem Labs Team</p>
      </div>
    `;

    // ================= ADMIN EMAIL =================
    const adminHtml = `
      <div style="font-family:Arial;padding:20px;">
        <h2 style="color:#06b6d4;">üì• New Webinar Registration</h2>

        <p><strong>Webinar:</strong> ${finalWebinarTitle}</p>
        <p><strong>Name:</strong> ${name}</p>
        <p><strong>Email:</strong> ${email}</p>
        <p><strong>Phone:</strong> ${phone}</p>
        <p><strong>Institute:</strong> ${institute}</p>
        <p><strong>Department:</strong> ${department}</p>
        <p><strong>Designation:</strong> ${designation}</p>
        <p><strong>Questions:</strong> ${questions}</p>

        <hr>
        <p>‚úîÔ∏è The student has registered for the FREE webinar.</p>
      </div>
    `;

    // ‚≠ê RETURN FAST SUCCESS (NO EMAIL WAIT TIME)
    res.json({
      status: "success",
      message: "Registration successful! Emails sent in background.",
    });

    // ================= SEND EMAILS IN BACKGROUND =================
    setTimeout(async () => {
      try {
        // USER EMAIL
        await resend.emails.send({
          from: FROM,
          to: email,
          subject: `üéâ Registration Confirmed ‚Äì ${finalWebinarTitle}`,
          html: userHtml,
        });

        // ADMIN EMAIL
        await resend.emails.send({
          from: FROM,
          to: ADMIN,
          subject: `üì• New Webinar Registration ‚Äì ${finalWebinarTitle}`,
          html: adminHtml,
        });

        console.log("üìß Webinar emails sent successfully (user + admin)");
      } catch (err) {
        console.error("‚ùå Email send failed:", err.message);
      }
    }, 30); // non-blocking background

  } catch (error) {
    console.error("WEBINAR ERROR:", error);
    return res.status(500).json({
      status: "error",
      message: "Server error: " + error.message,
    });
  }
});